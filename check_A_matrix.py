"""
快速验证A矩阵是否为满秩的脚本
使用方法: python check_A_matrix.py
"""
import torch

# 从文件中读取A矩阵（复制A_matrix的内容到这里）
A_matrix = [
    [2, -1,  0,  3,  1, -2,  1,  0, -1,  2,  1,  0,  3, -1,  2,  1],
    [1,  1,  2, -1,  0,  1, -2,  3,  1,  0, -1,  2,  1,  1, -1,  0],
    [0,  2, -1,  1,  3,  0,  1, -2,  2,  1,  0, -1,  1,  2,  1,  3],
    [-1,  0,  1,  2, -1,  3,  0,  1, -2,  1,  2,  1,  0, -1,  3,  2],
    [3,  1, -2,  0,  1,  2, -1,  0,  3, -1,  2,  1, -2,  3,  1,  0],
    [1, -2,  3,  1,  0, -1,  2,  1,  0,  3, -1,  2,  1,  0, -2,  3],
    [0,  1,  0, -2,  3,  1,  1, -1,  2,  1,  0,  3, -1,  2,  1,  0],
    [2,  1, -1,  3,  1,  0, -2,  1,  3,  0,  1, -1,  2,  1,  0,  3],
    [-1,  3,  1,  0, -1,  2,  1,  0,  1, -2,  3,  1,  0, -1,  2,  1],
    [1,  0,  3, -1,  2,  1,  0,  3, -1,  2,  1,  0,  3, -1,  2,  1],
    [0, -1,  2,  1,  0,  3, -1,  2,  1,  0,  3, -1,  2,  1,  0,  3],
    [3,  1,  0, -1,  2,  1,  3,  0, -1,  2,  1,  3,  0, -1,  2,  1],
    [1,  2,  1,  0,  3, -1,  2,  1,  0,  3, -1,  2,  1,  0,  3, -1],
    [-2,  1,  3,  0, -1,  2,  1,  3,  0, -1,  2,  1,  3,  0, -1,  2],
    [1,  0, -1,  2,  1,  3,  0, -1,  2,  1,  3,  0, -1,  2,  1,  3],
    [2,  1,  0, -1,  3,  1,  2,  1,  0, -1,  3,  1,  2,  1,  0, -1]
]

A = torch.tensor(A_matrix, dtype=torch.float32)
rank = torch.linalg.matrix_rank(A)
det = torch.linalg.det(A)

print(f"矩阵形状: {A.shape}")
print(f"矩阵秩: {rank}")
print(f"行列式: {det:.2f}")

if rank == 16:
    print("✓ 矩阵是满秩的！")
else:
    print(f"✗ 警告：矩阵不是满秩的（秩={rank}，应该是16）")

if abs(det) > 1e-6:
    print("✓ 行列式非零")
else:
    print("✗ 警告：行列式接近0，矩阵可能奇异")
